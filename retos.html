<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="manifest" href="manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Econnect - Retos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; background: linear-gradient(rgba(10, 30, 15, 0.85), rgba(10, 30, 15, 0.95)), url('https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=2074&auto=format&fit=crop'); background-size: cover; background-position: center; background-attachment: fixed; color: white; min-height: 100vh; display: flex; justify-content: center; }
        .app-container { width: 100%; max-width: 500px; padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; height: 100vh; }

        /* TARJETA DE RETO (Glass) */
        .challenge-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 30px;
            padding: 0; /* Sin padding para que la imagen llegue al borde */
            overflow: hidden;
            display: flex; flex-direction: column;
            flex-grow: 1;
            margin-bottom: 20px;
            position: relative;
        }

        /* IMAGEN HEADER */
        .challenge-header-img {
            width: 100%; height: 200px; object-fit: cover;
            mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
        }
        
        .close-btn {
            position: absolute; top: 20px; right: 20px; font-size: 24px; 
            color: white; cursor: pointer; z-index: 10; background: rgba(0,0,0,0.3);
            width: 40px; height: 40px; border-radius: 50%; display: flex; 
            justify-content: center; align-items: center;
        }

        /* CONTENIDO */
        .content-wrapper { padding: 20px 25px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; }

        .tag { display: inline-block; background: rgba(74, 222, 128, 0.2); color: #4ade80; padding: 5px 12px; border-radius: 15px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
        h1 { font-size: 26px; font-weight: 700; margin: 0 0 10px 0; }
        .desc { font-size: 14px; color: rgba(255,255,255,0.7); line-height: 1.5; margin-bottom: 30px; }

        /* LISTA DE PASOS */
        .steps-list { text-align: left; margin-bottom: 30px; }
        .step-item { display: flex; align-items: center; margin-bottom: 15px; color: rgba(255,255,255,0.9); font-size: 14px; }
        .step-icon { width: 30px; font-size: 20px; color: #4ade80; margin-right: 10px; text-align: center; }
        .step-icon.pending { color: rgba(255,255,255,0.3); }

        /* PROGRESO */
        .progress-section { margin-top: auto; margin-bottom: 20px; }
        .progress-info { display: flex; justify-content: space-between; font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 8px; font-weight: 600; }
        .progress-bar-bg { width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .progress-fill { width: 33%; height: 100%; background: #4ade80; border-radius: 10px; transition: width 1s ease; box-shadow: 0 0 10px rgba(74, 222, 128, 0.5); }

        /* BOT√ìN ACCI√ìN */
        .action-btn {
            width: 100%; background: #4ade80; color: #064e3b; border: none; padding: 16px;
            border-radius: 50px; font-weight: 700; font-size: 16px; cursor: pointer;
            box-shadow: 0 5px 20px rgba(74, 222, 128, 0.3); transition: all 0.2s;
            font-family: 'Poppins', sans-serif;
        }
        .action-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(74, 222, 128, 0.5); }

    </style>
</head>
<body>

<div class="app-container">
    
    <div class="challenge-card">
        <div class="close-btn" onclick="location.href='mapa.html'"><i class="fa-solid fa-xmark"></i></div>
        
        <img src="https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?q=80&w=2013&auto=format&fit=crop" class="challenge-header-img">

        <div class="content-wrapper">
            <div><span class="tag">Reto Diario</span></div>
            <h1>Planta un √Årbol</h1>
            <p class="desc">Conecta con la tierra hoy. Busca un lugar adecuado en tu comunidad y dale vida al planeta sembrando una semilla o un plant√≥n.</p>

            <div class="steps-list">
                <div class="step-item">
                    <i class="fa-solid fa-circle-check step-icon"></i>
                    <span>Encuentra el lugar ideal</span>
                </div>
                <div class="step-item">
                    <i class="fa-solid fa-leaf step-icon"></i>
                    <span>Siembra tu √°rbol con cuidado</span>
                </div>
                <div class="step-item">
                    <i class="fa-solid fa-camera step-icon pending" id="icon-camera"></i>
                    <span>Sube una foto de evidencia</span>
                </div>
            </div>

            <div class="progress-section">
                <div class="progress-info">
                    <span>Tu Progreso</span>
                    <span id="progress-text">1/3</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-fill" id="progress-bar"></div>
                </div>
            </div>

            <input type="file" id="camera-input" accept="image/*" capture="environment" style="display:none" onchange="fotoSubida()">
            <button class="action-btn" id="btn-action" onclick="abrirCamara()">Completar Reto</button>
        </div>
    </div>

</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = { apiKey: "AIzaSyA5lPDFaH8W-miDJHB3sDKdD5fiJt8d9-8", authDomain: "ecconect-ae607.firebaseapp.com", projectId: "ecconect-ae607", storageBucket: "ecconect-ae607.firebasestorage.app", messagingSenderId: "241708782882", appId: "1:241708782882:web:514d895119f9f7c3fa817b", measurementId: "G-KJ3FLCHZCG" };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    onAuthStateChanged(auth, (user) => { if (!user) {} });

    window.abrirCamara = function() { document.getElementById('camera-input').click(); }

    window.fotoSubida = function() {
        alert("¬°Genial! Foto subida correctamente üì∏");
        
        // Animaci√≥n de completado
        document.getElementById('progress-bar').style.width = "100%";
        document.getElementById('progress-text').textContent = "3/3";
        document.getElementById('progress-text').style.color = "#4ade80";
        
        const camIcon = document.getElementById('icon-camera');
        camIcon.className = "fa-solid fa-circle-check step-icon";
        camIcon.style.color = "#4ade80";

        const btn = document.getElementById('btn-action');
        btn.textContent = "¬°Reto Completado!";
        btn.style.background = "white";
        btn.style.color = "#1b5e20";
        btn.onclick = null;
    }
</script>

</body>
</html>