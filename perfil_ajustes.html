<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="manifest" href="manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Econnect - Ajustes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; background: linear-gradient(rgba(10, 30, 15, 0.85), rgba(10, 30, 15, 0.95)), url('https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?q=80&w=2074&auto=format&fit=crop'); background-size: cover; background-position: center; background-attachment: fixed; color: white; min-height: 100vh; display: flex; justify-content: center; }
        
        .app-container { width: 100%; max-width: 500px; padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; }

        /* CABECERA */
        .header { display: flex; align-items: center; margin-bottom: 30px; margin-top: 10px; }
        .back-btn { font-size: 24px; color: white; cursor: pointer; background: none; border: none; padding: 0; margin-right: 20px; }
        h1 { font-size: 24px; font-weight: 700; margin: 0; }

        /* PERFIL RESUMEN */
        .profile-summary { display: flex; align-items: center; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 20px; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1); }
        .mini-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; margin-right: 15px; }
        .user-info h2 { font-size: 16px; margin: 0; font-weight: 600; }
        .user-info p { font-size: 12px; color: #4ade80; margin: 0; }

        /* GRUPOS */
        .section-label { font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 10px; margin-left: 10px; text-transform: uppercase; letter-spacing: 1px; }
        
        .settings-group { background: rgba(255, 255, 255, 0.05); border-radius: 20px; overflow: hidden; margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.05); }

        .list-item { display: flex; align-items: center; padding: 18px 20px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: background 0.2s; }
        .list-item:last-child { border-bottom: none; }
        .list-item:hover { background: rgba(255,255,255,0.1); }

        .item-icon { width: 30px; font-size: 18px; color: #4ade80; margin-right: 10px; }
        .item-text { flex-grow: 1; font-size: 15px; font-weight: 400; }
        .item-right { color: rgba(255,255,255,0.3); font-size: 14px; display: flex; align-items: center; gap: 10px; }

        /* SWITCH */
        .switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(255,255,255,0.2); transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #4ade80; }
        input:checked + .slider:before { transform: translateX(18px); }

        /* LOGOUT */
        .logout-item { color: #fca5a5; }
        .logout-item .item-icon { color: #fca5a5; }
    </style>
</head>
<body>

<div class="app-container">
    
    <div class="header">
        <button class="back-btn" onclick="location.href='mapa.html'"><i class="fa-solid fa-chevron-left"></i></button>
        <h1>Ajustes</h1>
    </div>

    <div class="profile-summary">
        <img src="https://i.pravatar.cc/300?u=maria_navarro" class="mini-avatar">
        <div class="user-info">
            <h2 id="user-name-settings">Cargando...</h2>
            <p>Gestionar cuenta</p>
        </div>
    </div>

    <div class="section-label">General</div>
    <div class="settings-group">
        <div class="list-item">
            <i class="fa-regular fa-circle-user item-icon"></i>
            <span class="item-text">Editar Perfil</span>
            <i class="fa-solid fa-chevron-right item-right"></i>
        </div>
        <div class="list-item">
            <i class="fa-solid fa-bell item-icon"></i>
            <span class="item-text">Notificaciones</span>
            <i class="fa-solid fa-chevron-right item-right"></i>
        </div>
        <div class="list-item">
            <i class="fa-solid fa-moon item-icon"></i>
            <span class="item-text">Modo Oscuro</span>
            <label class="switch">
                <input type="checkbox" checked disabled> <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="section-label">Soporte</div>
    <div class="settings-group">
        <div class="list-item">
            <i class="fa-solid fa-circle-question item-icon"></i>
            <span class="item-text">Ayuda</span>
            <i class="fa-solid fa-chevron-right item-right"></i>
        </div>
        <div class="list-item logout-item" id="btn-logout">
            <i class="fa-solid fa-arrow-right-from-bracket item-icon"></i>
            <span class="item-text">Cerrar Sesi√≥n</span>
        </div>
    </div>

</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyA5lPDFaH8W-miDJHB3sDKdD5fiJt8d9-8", authDomain: "ecconect-ae607.firebaseapp.com", projectId: "ecconect-ae607", storageBucket: "ecconect-ae607.firebasestorage.app", messagingSenderId: "241708782882", appId: "1:241708782882:web:514d895119f9f7c3fa817b", measurementId: "G-KJ3FLCHZCG" };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            const docRef = doc(db, "usuarios", user.uid);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                document.getElementById("user-name-settings").textContent = docSnap.data().nombre;
            }
        } else {
            window.location.href = "index.html";
        }
    });

    document.getElementById('btn-logout').addEventListener('click', async () => {
        await signOut(auth);
        window.location.href = "index.html";
    });
</script>

</body>
</html>